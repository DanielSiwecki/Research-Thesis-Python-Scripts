
Code 3.4 Difference-in-Differences FDR Adjustments Model Script

import pandas as pd
import statsmodels.api as sm
from statsmodels.stats.multitest import multipletests

# read in data from the excel sheet
data = pd.read_excel(r'/Excel/File/Location')

# create a binary variable indicating post-treatment
data['post'] = (data['time'] == 'post').astype(int)
# create binary variables for the treatment groups
group_dummies = pd.get_dummies(data['group'])
data = pd.concat([data, group_dummies], axis=1)

# specify the dependent variable and independent variables
y = data['Variable1']
X = data[['post', 'GroupB', 'GroupC', 'GroupD', 'GroupE',
 'covariate1', 'covariate2', 'covariate3', 'covariate4', 
'covariate5',
 'covariate6', 'covariate7', 'covariate8']]

# fit the linear regression model
model = sm.OLS(y, X).fit()

# get the p-values from the model
p_values = model.pvalues

# adjust the p-values using FDR control
adjusted_p_values = multipletests(p_values, method='fdr_bh')[1]

# create a DataFrame with the results
results = pd.DataFrame({'Coefficients': model.params,
 'Standard Errors': model.bse,
'P-values': p_values,
 'Adjusted P-values (FDR)': adjusted_p_values})

# print the summary of the regression results
print(results)
