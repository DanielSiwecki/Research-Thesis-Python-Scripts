
Code 3.3 Difference-in-Differences Robust Standard Error (HC3) Model Script

import pandas as pd
import statsmodels.api as sm

# read in data from the excel sheet
data = pd.read_excel(r'/Excel/File/Location/')

# create a binary variable indicating post-treatment
data['post'] = (data['time'] == 'post').astype(int)

# create binary variables for the treatment groups
group_dummies = pd.get_dummies(data['group'])
data = pd.concat([data, group_dummies], axis=1)

# specify the dependent variable and independent variables
y = data['Variable1']
X = data[['post', 'GroupB', 'GroupC', 'GroupD', 'GroupE',
 'covariate1', 'covariate2', 'covariate3', 'covariate4', 
'covariate5',
 'covariate6', 'covariate7', 'covariate8']]

# fit the linear regression model with robust standard errors
model = sm.OLS(y, X)

results = model.fit(cov_type='HC3') # Specify the type of robust 
covariance estimator

# print the summary of the regression results
print(results.summary()
